<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>おうちレストラン</title>

  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      --ink:#0b0f14;
      --bg:#f7f7ef;
      --panel:#ffffff;
      --blue:#1d4ed8;
      --blue-2:#0b3ea8;
      --gold:#fbbf24;
      --grid:#e6e2cc;
      --focus:#1d4ed8;
      --success:#22c55e;
      --danger:#ef4444;
    }
    body.hc{
      --bg:#ffffff; --panel:#ffffff;
      --blue:#1438b8; --blue-2:#0b2a88;
      --gold:#ffcc00; --grid:#e0e0e0;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:
        repeating-linear-gradient(0deg, var(--grid) 0 2px, transparent 2px 24px),
        repeating-linear-gradient(90deg, var(--grid) 0 2px, transparent 2px 24px),
        var(--bg);
      color:var(--ink);
      font-family:'Press Start 2P', monospace;
      line-height:1.6; letter-spacing:0.5px;
    }
    .wrap{ max-width:720px; margin:0 auto; padding:16px 12px 120px; }
    .title{ display:flex; gap:8px; align-items:center; justify-content:center; margin:16px 0 8px; font-size:18px; }
    .tbar{ display:flex; gap:8px; justify-content:center; flex-wrap:wrap; margin-bottom:16px; }
    .btn{
      appearance:none; border:none; background:var(--blue); color:#fff;
      padding:14px 16px; border:3px solid var(--blue-2);
      box-shadow:4px 4px 0 var(--blue-2);
      font:inherit; font-size:12px; border-radius:6px; cursor:pointer;
      transition:transform .02s ease-in;
    }
    .btn:active{ transform:translate(2px,2px); box-shadow:2px 2px 0 var(--blue-2); }
    .btn.alt{ background:var(--gold); color:#000; border-color:#c58f00; box-shadow:4px 4px 0 #c58f00; }
    .btn.success{ background:var(--success); border-color:#15803d; box-shadow:4px 4px 0 #15803d; }
    .btn.danger{ background:var(--danger); border-color:#991b1b; box-shadow:4px 4px 0 #991b1b; }

    .panel{ background:var(--panel); border:4px solid var(--ink); box-shadow:6px 6px 0 var(--ink); padding:12px; margin:16px 0; border-radius:10px; }
    .section-title{ display:flex; align-items:center; gap:8px; margin:0 0 10px; font-size:14px; color:var(--blue-2); }

    .menu{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    @media (max-width:520px){ .menu{ grid-template-columns:1fr; } }
    .card{ border:3px solid var(--blue-2); border-radius:10px; padding:10px; background:linear-gradient(0deg, rgba(255,255,255,.9), rgba(255,255,255,.9)), var(--panel); }

    .item{
      display:flex; align-items:center; justify-content:space-between; gap:8px;
      margin:8px 0 0; padding:12px; border:2px dashed var(--blue-2);
      border-radius:10px; background:#fff; cursor:pointer; user-select:none; touch-action:manipulation;
    }
    .item:hover{ background:#f3f7ff; }
    .item:focus{ outline:3px dashed var(--focus); outline-offset:3px; }
    .label{ display:flex; align-items:center; gap:8px; font-size:12px; }
    .badge{ min-width:28px; height:28px; display:inline-grid; place-items:center; background:var(--gold); color:#000; border:2px solid #c58f00; border-radius:6px; font-size:12px; }

    .order-item{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px; margin:8px 0 0; border:2px solid var(--ink); border-radius:10px; background:#fff; }
    .qty{ display:flex; align-items:center; gap:6px; }
    .qty button{ width:32px; height:32px; font:inherit; font-size:14px; border:2px solid var(--ink); background:var(--gold); border-radius:6px; cursor:pointer; }

    .muted{ font-size:11px; opacity:.8; }
    .row{ display:flex; align-items:center; gap:8px; justify-content:space-between; flex-wrap:wrap; margin-top:10px; }
    input.note{ width:100%; padding:12px; border:2px solid var(--ink); border-radius:8px; font:inherit; font-size:12px; }
    .status{ margin-top:8px; font-size:12px; }

    :focus-visible{ outline:3px dashed var(--focus); outline-offset:3px; }
    @media (prefers-reduced-motion: reduce){ .btn, .btn:active{ transition:none; box-shadow:none; transform:none; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">🍽️ おうちレストラン · ピクセル版</div>

    <div class="tbar">
      <button class="btn" id="hcBtn" aria-pressed="false">視認性アップ</button>
      <button class="btn alt" id="clearBtn">カートを空にする</button>
    </div>

    <!-- MENU: MAINS -->
    <section class="panel" aria-labelledby="mainsTitle">
      <h2 id="mainsTitle" class="section-title">🍚 メイン</h2>
      <div class="menu">
        <div class="card" aria-label="メイン1">
          <div class="item" tabindex="0" data-name="ネギトロ丼"><span class="label">🍣 ネギトロ丼</span><span class="badge" aria-hidden="true">＋</span></div>
          <div class="item" tabindex="0" data-name="ハンバーグライス"><span class="label">🍖 ハンバーグライス</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="唐揚げ定食"><span class="label">🍗 唐揚げ定食</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="明太子パスタ"><span class="label">🍝 明太子パスタ</span><span class="badge">＋</span></div>
        </div>
        <div class="card" aria-label="メイン2">
          <div class="item" tabindex="0" data-name="タコライス"><span class="label">🌮 タコライス</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="春巻き"><span class="label">🥢 春巻き</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="餃子"><span class="label">🥟 餃子</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="麻婆豆腐"><span class="label">🍲 麻婆豆腐</span><span class="badge">＋</span></div>
        </div>
      </div>
    </section>

    <!-- MENU: SIDES -->
    <section class="panel" aria-labelledby="sidesTitle">
      <h2 id="sidesTitle" class="section-title">🥗 サイド</h2>
      <div class="menu">
        <div class="card" aria-label="サイド1">
          <div class="item" tabindex="0" data-name="チンゲン菜ガーリック"><span class="label">🧄 チンゲン菜ガーリック</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="茄子の煮浸し"><span class="label">🍆 茄子の煮浸し</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="茄子の味噌汁"><span class="label">🍲 茄子の味噌汁</span><span class="badge">＋</span></div>
        </div>
        <div class="card" aria-label="サイド2">
          <div class="item" tabindex="0" data-name="プチトマト"><span class="label">🍅 プチトマト</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="アボカドしょう油"><span class="label">🥑 アボカドしょう油</span><span class="badge">＋</span></div>
        </div>
      </div>
    </section>

    <!-- MENU: DRINKS -->
    <section class="panel" aria-labelledby="drinksTitle">
      <h2 id="drinksTitle" class="section-title">🥤 ドリンク</h2>
      <div class="menu">
        <div class="card" aria-label="ドリンク">
          <div class="item" tabindex="0" data-name="本日のジュース"><span class="label">🧃 本日のジュース</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="本日のお酒"><span class="label">🍶 本日のお酒</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="ビール"><span class="label">🍺 ビール</span><span class="badge">＋</span></div>
          <div class="item" tabindex="0" data-name="ワイン"><span class="label">🍷 ワイン</span><span class="badge">＋</span></div>
        </div>
      </div>
    </section>

    <!-- CART / ORDER -->
    <section class="panel" aria-labelledby="orderTitle">
      <h2 id="orderTitle" class="section-title">🛒 カート</h2>
      <p class="muted">メニューをタップすると追加。数量は下で調整、最後に「注文する」。</p>
      <div id="live" class="muted" aria-live="polite"></div>
      <div id="order"></div>

      <div class="row">
        <input class="note" id="note" placeholder="メモ（例：氷少なめ、辛さ控えめ など）">
        <button class="btn success" id="orderBtn">注文する</button>
      </div>
      <div id="status" class="status"></div>
    </section>
  </div>

  <script>
    // Put your Apps Script Web App URL here:
    const WEBHOOK_URL = "YOUR_WEB_APP_URL_HERE";

    const order = new Map(); // { name -> qty }
    const orderEl = document.getElementById('order');
    const live = document.getElementById('live');
    const hcBtn = document.getElementById('hcBtn');
    const clearBtn = document.getElementById('clearBtn');
    const orderBtn = document.getElementById('orderBtn');
    const noteEl = document.getElementById('note');
    const statusEl = document.getElementById('status');

    function addItem(name){
      const q = order.get(name) || 0;
      order.set(name, q + 1);
      render();
      live.textContent = `${name} を追加（合計 ${order.get(name)}）`;
    }

    function changeQty(name, delta){
      const q = order.get(name) || 0;
      const nq = q + delta;
      if(nq <= 0){ order.delete(name); }
      else{ order.set(name, nq); }
      render();
    }

    function render(){
      orderEl.innerHTML = '';
      if(order.size === 0){
        orderEl.innerHTML = '<p class="muted">カートは空です。</p>';
        return;
      }
      order.forEach((qty, name) => {
        const row = document.createElement('div');
        row.className = 'order-item';
        row.innerHTML = `
          <div class="label">✅ ${name}</div>
          <div class="qty" role="group" aria-label="${name} の数量">
            <button aria-label="${name} を減らす">−</button>
            <strong>${qty}</strong>
            <button aria-label="${name} を増やす">＋</button>
          </div>
        `;
        const [minusBtn, plusBtn] = row.querySelectorAll('button');
        minusBtn.addEventListener('click', () => changeQty(name, -1));
        plusBtn.addEventListener('click', () => changeQty(name, +1));
        orderEl.appendChild(row);
      });
    }

    // Bind menu items (tap to add)
    document.querySelectorAll('.item').forEach(el => {
      el.addEventListener('click', () => addItem(el.dataset.name));
      el.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault(); addItem(el.dataset.name);
        }
      });
    });

    // High-contrast toggle
    hcBtn.addEventListener('click', () => {
      const on = document.body.classList.toggle('hc');
      hcBtn.setAttribute('aria-pressed', on ? 'true' : 'false');
      hcBtn.textContent = on ? '視認性アップ（ON）' : '視認性アップ';
    });

    // Clear cart
    clearBtn.addEventListener('click', () => {
      order.clear(); render();
      live.textContent = 'カートを空にしました。';
    });

    // Submit order → send to your webhook
    orderBtn.addEventListener('click', async () => {
      if(order.size === 0){
        statusEl.textContent = 'カートが空です。';
        return;
      }
      const items = Array.from(order, ([name, qty]) => ({ name, qty }));
      const note = noteEl.value.trim();

      statusEl.textContent = '送信中…';

      try{
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          mode: 'no-cors', // Apps Script will still receive it
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ items, note })
        });

        statusEl.textContent = '✅ 注文を送信しました。ありがとうございます！';
        order.clear(); render(); noteEl.value = '';
      }catch(err){
        statusEl.textContent = '❌ 送信に失敗しました。ネットワークを確認してください。';
      }
    });

    // initial render
    render();
  </script>
</body>
</html>
